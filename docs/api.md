## API

If you're using CLI, the options (expect those marked as `API only`) can be kept at `ream.config.js` .

You can also check out [custom server example](/examples/custom-server/server.js) which is custom server that uses the API.

### ream([options])

Return an ream app instance:

```js
const app = ream(options)
```

#### options

##### html

Options for `html-webpack-plugin`, by default it is:

```js
{
  title: 'Ream App',
  template: 'built-in template'
}
```

##### dev

Type: `boolean`<br>
Default: `false`

*API only*

Run server in development mode which has hot-reloading enabled.

##### cwd

Type: `string`<br>
Default: `process.cwd()`

##### entry

Type: `string`<br>
Default: `src/index.js`

The entry file that exports router instance (and others optional exports like `store`, `App`), relative to `cwd` directory.

##### babel

Type: `Object`<br>
Default: `{ presets: ['vue-app'] }`

Babel options.

##### postcss

Type: `Object`<br>
Default: `{}`

PostCSS options.

##### extendWebpack

Type: `function`

Extend webpack config generated by [webpack-chain](https://github.com/mozilla-rpweb/webpack-chain), for example to show progress bar while building client bundle in production mode:

```js
const ProgressPlugin = require('webpack/lib/ProgressPlugin')

ream({
  extendWebpack(config, { type, dev }) {
    if (type === 'client' && !dev) {
      config.plugin('display-progress')
        .use(ProgressPlugin)
    }
  }
})
```

##### plugins

Type: `Array`<br>
Default: `[]`

Use an array of plugins.

##### externalsWhitelist

Type: `Array`<r>
Default: `[]`

An array for the externals to [whitelist](https://github.com/liady/webpack-node-externals#optionswhitelist-), so they will be included in the server bundle.

<p class="warning">
By default we exclude all 3rd-party node modules, which means any `require` or `import` for them will be converted to raw commonjs `require` call which will be used in Node.js environment. If you want to import any libraries in your code and they're are js libraries, eg: images/fonts libraries, **do add them into this option.**
</p>


#### app.prepare()

Prepare server, returns a Promise

```js
app.prepare()
  .then(() => {
    // server is ready
  })
```

#### app.getRequestHandler()

Return a middleware for `http.createServer` instance:

```js
app.prepare()
  .then(() => {
    const server = http.createServer((req, res) => {
      const handle = app.getRequestHandler()
      handle(req, res)
    })
    server.listen(4000)
  })
```

If you're running in production mode, make sure you have run `app.build()` first.

#### app.build()

Build server bundle and client bundle in production mode.

#### app.generate([options])

If you're using CLI, options for this method should be placed under `generate` property.

##### options

###### routes

Type: `Array` `object`<br>
Required: `true`

Generate static files for an array of routes, query parameter is not support.

```js
app.generate({
  routes: ['/', '/about/', '/user/egoist/', '/user/trump/']
}).then(dir => {
  console.log(`Generated into ${dir}`)
})
```

**Note:** The route must end with `/`.

The `routes` could also be a plain object:

```js
app.generate({
  routes: {
    '/': true,
    '/user/:name/': [
      { name: 'egoist' },
      { name: 'trump' },
      { name: 'my name' }
    ]
  }
})
```

The value of each entry in `routes` option should be `true` or an array of params, and we compile it into valid string using [path-to-regexp](https://github.com/pillarjs/path-to-regexp#compile-reverse-path-to-regexp)

###### homepage

Type: `string`<br>
Default: `/`

The root path to load static assets, if you're deploying the generated static files to subpath like `http://example.com/blog`, please set it to `/blog/` or `http://example.com/blog/`

#### app.stats

Webpack stats, it only exists when `ready` event is fired once.

```js
app.on('ready', () => {
  console.log(app.stats)
  // { server, client }
  // stats for server bundle and client bundle
})
```

#### Events

##### ready

Each time app is ready , this event will be emitted.

```js
app.on('ready', () => {
  console.log('Ready!')
})
```

Since webpack will rebuild when you're running development server, this event will be emitted multiple times, to only listen for once, use `app.once`, basically `app` is created from a subclass of Node.js's `events` modules.

### createConfig([options])

Like `ream([options])` but returns a webpack-chain instance.

Create webpack config only.

```js
const createConfig = require('ream/lib/create-config')

const config = createConfig({
  type, // `server` or `client`
  dev,
  // ...
})

const webpackConfig = config.toConfig()
// perform your own build process
```

The `config` is a [webpack-chain](https://github.com/mozilla-neutrino/webpack-chain) config instance, which allows you to easily modify original webpack config.


### ream.displayStats({ server, client })

Pretty print webpack stats, the argument should be `app.stats` or in `{ server, client }` format.

